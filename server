#!/usr/bin/env bash

set -euo pipefail
IFS=$'\n\t'

server=
end() {
    kill "$server"
    echo " server stopped."
    exit 0
}
trap end INT

static &> /dev/null &
server="$!"
sleep 1 && open "http://localhost:8080" &
while true; do
    find . -not -path "*.git*" | entr -d make || [[ "$?" == 2 ]]
done
