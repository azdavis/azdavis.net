#!/usr/bin/env bash

set -euo pipefail
IFS=$'\n\t'

server=
end() {
    kill "$server"
    echo -n " server and auto-make stopped."
}
trap end EXIT

ruby -run -e httpd &> /dev/null &
server="$!"
open -g "http://localhost:8080"
while make || true; do echo -n "waiting..." $'\r' && sleep 2; done

true
